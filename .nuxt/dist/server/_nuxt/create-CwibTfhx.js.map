{"version":3,"file":"create-CwibTfhx.js","sources":["../../../../pages/category/subcategory/create.vue"],"sourcesContent":["<template>\n  <div class=\"card shadow border-0 mb-7\">\n    <Loader :loading=\"loading\" />\n    {{ form }}\n    <div class=\"card-body\">\n      <form @submit.prevent=\"createCategory()\">\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label for=\"exampleInputEmail1\" class=\"form-label\">ประเภท</label>\n              <input\n                type=\"text\"\n                class=\"form-control form-control-sm\"\n                v-model=\"form.name\"\n              />\n            </div>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label for=\"exampleInputEmail1\" class=\"form-label\">หมวดหมู่</label>\n              <select class=\"form-select form-select-sm\" @change=\"selectedCategory\">\n                <option value=\"\" disabled selected>เลือกหมวดหมู่</option>\n                <option\n                  :value=\"category.id\"\n                  v-for=\"(category, index) in categorys\"\n                  :key=\"index\"\n                >\n                  {{ category.name }}\n                </option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <button type=\"submit\" class=\"btn btn-primary btn-sm\" :disabled=\"loading\">\n          {{ loading ? \"กำลังบันทึก...\" : \"บันทึก\" }}\n        </button>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { categoryData } from \"~/types/categoryType\";\n\nconst form = ref({\n  name: \"\",\n  category: \"\",\n});\nconst categorys = ref<categoryData[] | null>(null);\n\nconst loading = ref(false);\ninterface Toast {\n  success: (message: string, options?: { position?: string; timeout?: number }) => void;\n}\nimport { useNuxtApp } from \"#app\";\nconst nuxtApp = useNuxtApp();\n\nconst showToast = (text: string) => {\n  const toastInstance = nuxtApp.$toast as Toast;\n  toastInstance.success(text, {\n    position: \"bottom-right\",\n    timeout: 2500,\n  });\n};\n\nconst createCategory = async () => {\n  loading.value = true;\n  try {\n    const response = await fetch(\"/api/subcategory\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(form.value),\n    });\n    const data = await response.json();\n    showToast(\"บันทึกสำเร็จ\");\n    navigateTo({ name: \"category-subcategory\" });\n  } catch (e) {\n    console.log(e);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst getCategory = async () => {\n  loading.value = true;\n  try {\n    const response = await fetch(\"/api/category\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await response.json();\n    categorys.value = data.data;\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst selectedCategory = async (event: Event) => {\n  try {\n    const target = event.target as HTMLSelectElement;\n    const selectedValue = target.value;\n\n    // สร้าง object ใหม่เพื่อกำหนดค่าให้กับ form.value.category\n    form.value.category = selectedValue;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nonMounted(() => {\n  getCategory();\n});\n</script>\n\n<style scoped></style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AA4CA,UAAM,OAAO,IAAI;AAAA,MACf,MAAM;AAAA,MACN,UAAU;AAAA,IAAA,CACX;AACK,UAAA,YAAY,IAA2B,IAAI;AAE3C,UAAA,UAAU,IAAI,KAAK;;;;;;;;;;;;;;;;;;;"}