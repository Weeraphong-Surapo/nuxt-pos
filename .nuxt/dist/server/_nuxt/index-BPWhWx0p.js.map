{"version":3,"file":"index-BPWhWx0p.js","sources":["../../../../components/TableCustomer.vue","../../../../pages/customer/index.vue"],"sourcesContent":["<template>\n  <EasyDataTable\n    :headers=\"headers\"\n    :items=\"customers\"\n    :loading=\"loading\"\n    theme-color=\"#5c60f5\"\n    show-index\n  >\n    <template #item-action=\"{ id }\">\n      <div class=\"btn-group\">\n        <NuxtLink\n          :to=\"{ name: 'customer-id', params: { id: id } }\"\n          class=\"btn btn-warning btn-sm\"\n          >แก้ไข</NuxtLink\n        >\n        <button class=\"btn btn-danger btn-sm\" type=\"button\" @click=\"confirmDelete(id)\">\n          ลบ\n        </button>\n      </div>\n    </template>\n  </EasyDataTable>\n\n  <Teleport to=\"body\">\n    <!-- use the modal component, pass in the prop -->\n\n    <ConfirmModal\n      :deleteData=\"deleteCustomer\"\n      :show=\"showModal\"\n      @close=\"showModal = false\"\n    >\n    </ConfirmModal>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Header } from \"vue3-easy-data-table\";\ninterface Toast {\n  success: (message: string, options?: { position?: string; timeout?: number }) => void;\n}\nimport { useNuxtApp } from \"#app\";\nconst nuxtApp = useNuxtApp();\n\nconst showToast = (text: string) => {\n  const toastInstance = nuxtApp.$toast as Toast;\n  toastInstance.success(text, {\n    position: \"bottom-right\",\n    timeout: 2500,\n  });\n};\nconst showModal = ref(false);\nconst dataId = ref(\"\");\n\nconst confirmDelete = (id: string) => {\n  dataId.value = id;\n  showModal.value = true;\n};\n\nconst headers: Header[] = [\n  { text: \"ชื่อ\", value: \"full_name\", sortable: true },\n  { text: \"เบอร์โทร\", value: \"phone\" },\n  { text: \"ไลน์\", value: \"line\" },\n  { text: \"ที่อยู่\", value: \"address\" },\n  { text: \"สร้างวันที่\", value: \"createdDate\" },\n  { text: \"จัดการ\", value: \"action\" },\n];\n\nconst props = defineProps([\"customers\", \"fetchCustomers\", \"loading\"]);\n\nconst deleteCustomer = async () => {\n  try {\n    const response = await fetch(\"/api/customer/\" + dataId.value, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    showToast(\"ลบข้อมูลสำเร็จ\");\n    props.fetchCustomers();\n  } catch (error) {\n    console.log(error);\n  }finally{\n    showModal.value = false;\n  }\n};\n</script>\n\n<style scoped></style>\n","<template>\n  <div class=\"card shadow border-0 mb-7\">\n    <div class=\"card-header d-flex justify-content-between align-items-center\">\n      <h5 class=\"mb-0\">ลูกค้าทั้งหมด</h5>\n      <!-- <div class=\"\">\n\n      </div> -->\n      <NuxtLink\n        class=\"btn-primary btn btn-sm\"\n        :to=\"{ name: 'customer-create' }\"\n      >\n        <i class=\"bi bi-patch-plus fs-6 me-2\"></i>เพิ่มลูกค้า</NuxtLink\n      >\n    </div>\n    <div class=\"card-body\">\n      <TableCustomer\n        :loading=\"loading\"\n        :fetchCustomers=\"getAlCustomers\"\n        :customers=\"customers\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup>\nconst loading = ref(false);\nconst customers = ref([]);\n\nconst getAlCustomers = async () => {\n  loading.value = true;\n  try {\n    const response = await fetch(\"/api/customer\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await response.json();\n    customers.value = data.data;\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nonMounted(() => {\n  getAlCustomers();\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA,UAAM,UAAU;AAEV,UAAA,YAAY,CAAC,SAAiB;AAClC,YAAM,gBAAgB,QAAQ;AAC9B,oBAAc,QAAQ,MAAM;AAAA,QAC1B,UAAU;AAAA,QACV,SAAS;AAAA,MAAA,CACV;AAAA,IAAA;AAEG,UAAA,YAAY,IAAI,KAAK;AACrB,UAAA,SAAS,IAAI,EAAE;AAEf,UAAA,gBAAgB,CAAC,OAAe;AACpC,aAAO,QAAQ;AACf,gBAAU,QAAQ;AAAA,IAAA;AAGpB,UAAM,UAAoB;AAAA,MACxB,EAAE,MAAM,QAAQ,OAAO,aAAa,UAAU,KAAK;AAAA,MACnD,EAAE,MAAM,YAAY,OAAO,QAAQ;AAAA,MACnC,EAAE,MAAM,QAAQ,OAAO,OAAO;AAAA,MAC9B,EAAE,MAAM,WAAW,OAAO,UAAU;AAAA,MACpC,EAAE,MAAM,eAAe,OAAO,cAAc;AAAA,MAC5C,EAAE,MAAM,UAAU,OAAO,SAAS;AAAA,IAAA;AAGpC,UAAM,QAAQ;AAEd,UAAM,iBAAiB,YAAY;AAC7B,UAAA;AACF,cAAM,WAAW,MAAM,MAAM,mBAAmB,OAAO,OAAO;AAAA,UAC5D,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,UAClB;AAAA,QAAA,CACD;AACD,kBAAU,gBAAgB;AAC1B,cAAM,eAAe;AAAA,eACd,OAAO;AACd,gBAAQ,IAAI,KAAK;AAAA,MAAA,UAClB;AACC,kBAAU,QAAQ;AAAA,MACpB;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzDF,UAAM,UAAU,IAAI,KAAK;AACzB,UAAM,YAAY,IAAI,CAAA,CAAE;AAExB,UAAM,iBAAiB,YAAY;AACjC,cAAQ,QAAQ;AAChB,UAAI;AACF,cAAM,WAAW,MAAM,MAAM,iBAAiB;AAAA,UAC5C,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,UACjB;AAAA,QACP,CAAK;AACD,cAAM,OAAO,MAAM,SAAS;AAC5B,kBAAU,QAAQ,KAAK;AAAA,MACxB,SAAQ,OAAO;AACd,gBAAQ,IAAI,KAAK;AAAA,MACrB,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}