{"version":3,"file":"index-DVXlFvBU.js","sources":["../../../../components/TableProduct.vue","../../../../pages/product/index.vue"],"sourcesContent":["<template>\n  <EasyDataTable\n    :headers=\"headers\"\n    :items=\"products\"\n    theme-color=\"#5c60f5\"\n    :loading=\"loading\"\n  >\n    <template #item-action=\"{ id }\">\n      <div class=\"btn-group\">\n        <!-- <button class=\"btn btn-primary btn-sm\">ดู</button> -->\n        <NuxtLink\n          :to=\"{ name: 'product-id', params: { id: id } }\"\n          class=\"btn btn-warning btn-sm\"\n          >แก้ไข</NuxtLink\n        >\n        <button class=\"btn btn-danger btn-sm\" type=\"button\" @click=\"confirmDelete(id)\">\n          ลบ\n        </button>\n      </div>\n    </template>\n    <template #item-image=\"{ file_path }\">\n      <img\n        :src=\"file_path\"\n        alt=\"\"\n        style=\"height: 70px; width: 90px; object-fit: cover\"\n        class=\"rounded\"\n      />\n    </template>\n  </EasyDataTable>\n\n  <Teleport to=\"body\">\n    <!-- use the modal component, pass in the prop -->\n\n    <ConfirmModal\n      :deleteData=\"deleteProduct\"\n      :show=\"showModal\"\n      @close=\"showModal = false\"\n    >\n    </ConfirmModal>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Header } from \"vue3-easy-data-table\";\n\nconst showModal = ref(false);\nconst dataId = ref(\"\");\n\nconst headers: Header[] = [\n  { text: \"บาร์โค้ด\", value: \"barcode\", sortable: true },\n  { text: \"รูปภาพ\", value: \"image\" },\n  { text: \"สินค้า\", value: \"name\", sortable: true },\n  { text: \"ต้นทุน\", value: \"cost\", sortable: true },\n  { text: \"ราคาขาย\", value: \"price\", sortable: true },\n  { text: \"หมวดหมู่\", value: \"category.name\", sortable: true },\n  { text: \"ประเภท\", value: \"sub_category.name\", sortable: true },\n  { text: \"จำนวน\", value: \"quantity\" },\n  { text: \"สถานนะ\", value: \"is_active\" },\n  // { text: \"LAST ATTENDED\", value: \"lastAttended\", width: 200 },\n  { text: \"จัดการ\", value: \"action\" },\n];\n\nconst props = defineProps([\"products\", \"fetchProduct\", \"loading\"]);\n\nconst deleteProduct = async () => {\n  try {\n    const response = await fetch(\"/api/product/\" + dataId.value, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    props.fetchProduct();\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst confirmDelete = (id: string) => {\n  dataId.value = id;\n  showModal.value = true;\n};\n</script>\n\n<style scoped></style>\n","<template>\n  <div class=\"card shadow border-0 mb-7\">\n    <div class=\"card-header d-flex justify-content-between align-items-center\">\n      <h5 class=\"mb-0\">สินค้าทั้งหมด</h5>\n      <div class=\"\">\n        <button class=\"btn btn-sm btn-success\" @click=\"exportData\">Export Excel</button>\n        <button class=\"btn btn-sm btn-secondary\" >Export PDF</button>\n        <button class=\"btn btn-sm btn-dark\"></button>\n      </div>\n      <NuxtLink class=\"btn-primary btn btn-sm\" :to=\"{ name: 'product-create' }\">\n        <i class=\"bi bi-patch-plus fs-6 me-2\"></i>เพิ่มสินค้า</NuxtLink\n      >\n    </div>\n    <div class=\"card-body\">\n      <TableProduct :products=\"items\" :fetchProduct=\"getProducts\" :loading=\"loading\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { useAuthStore } from '@/stores/authStore'\n\nconst authStore = useAuthStore()\nimport type { productData } from \"~/types/productType\";\nimport { exportToExcel } from \"~/utils/exportExcel\";\nimport { exportToPdf } from \"@/utils/exportPdf\";\n\n\ndefinePageMeta({\n  middleware: \"auth\"\n})\n\nconst items = ref<productData[] | []>([]);\nconst loading = ref<boolean>(false);\n\nconst exportDataPdf = () => {\n  exportToPdf(items.value,\"รายงานสินค้า\")\n};\n\nconst exportData = () => {\n  console.log(items.value);\n  let format_data: any = []; // Initialize as an array\n\n  items.value.forEach((product) => {\n    const formattedProduct = {\n      รหัสบาร์โค้ด: product.barcode,\n      สินค้า: product.name,\n      ราคา: product.price,\n      ต้นทุน: product.cost,\n      จำนวน: product.quantity,\n      หมวดหมู่: product.category.name,\n      ประเภท: product.sub_category.name,\n      รายละเอียด: product.description,\n      สถานะ: product.is_active,\n      รูปภาพ: product.file_path,\n    };\n    format_data.push(formattedProduct); // Push each formatted product\n  });\n  exportToExcel(format_data, \"รายงานสินค้า\");\n};\n\nconst getProducts = async () => {\n  loading.value = true;\n  try {\n    const response = await fetch(\"/api/product\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await response.json();\n    items.value = data.data;\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nonMounted(() => {\n  getProducts();\n  console.log(authStore.user);\n  \n});\n</script>\n<style scoped></style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CM,UAAA,YAAY,IAAI,KAAK;AACrB,UAAA,SAAS,IAAI,EAAE;AAErB,UAAM,UAAoB;AAAA,MACxB,EAAE,MAAM,YAAY,OAAO,WAAW,UAAU,KAAK;AAAA,MACrD,EAAE,MAAM,UAAU,OAAO,QAAQ;AAAA,MACjC,EAAE,MAAM,UAAU,OAAO,QAAQ,UAAU,KAAK;AAAA,MAChD,EAAE,MAAM,UAAU,OAAO,QAAQ,UAAU,KAAK;AAAA,MAChD,EAAE,MAAM,WAAW,OAAO,SAAS,UAAU,KAAK;AAAA,MAClD,EAAE,MAAM,YAAY,OAAO,iBAAiB,UAAU,KAAK;AAAA,MAC3D,EAAE,MAAM,UAAU,OAAO,qBAAqB,UAAU,KAAK;AAAA,MAC7D,EAAE,MAAM,SAAS,OAAO,WAAW;AAAA,MACnC,EAAE,MAAM,UAAU,OAAO,YAAY;AAAA;AAAA,MAErC,EAAE,MAAM,UAAU,OAAO,SAAS;AAAA,IAAA;AAGpC,UAAM,QAAQ;AAEd,UAAM,gBAAgB,YAAY;AAC5B,UAAA;AACF,cAAM,WAAW,MAAM,MAAM,kBAAkB,OAAO,OAAO;AAAA,UAC3D,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,UAClB;AAAA,QAAA,CACD;AACD,cAAM,aAAa;AAAA,eACZ,OAAO;AACd,gBAAQ,IAAI,KAAK;AAAA,MACnB;AAAA,IAAA;AAGI,UAAA,gBAAgB,CAAC,OAAe;AACpC,aAAO,QAAQ;AACf,gBAAU,QAAQ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1DF,iBAAa;AAUzB,UAAA,QAAQ,IAAwB,CAAA,CAAE;AAClC,UAAA,UAAU,IAAa,KAAK;AA4BlC,UAAM,cAAc,YAAY;AAC9B,cAAQ,QAAQ;AACZ,UAAA;AACI,cAAA,WAAW,MAAM,MAAM,gBAAgB;AAAA,UAC3C,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,UAClB;AAAA,QAAA,CACD;AACK,cAAA,OAAO,MAAM,SAAS;AAC5B,cAAM,QAAQ,KAAK;AAAA,eACZ,OAAO;AACd,gBAAQ,IAAI,KAAK;AAAA,MAAA,UACjB;AACA,gBAAQ,QAAQ;AAAA,MAClB;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}