{"version":3,"file":"create-roFt081_.js","sources":["../../../../pages/product/create.vue"],"sourcesContent":["<template>\n  <div class=\"card shadow border-0 mb-7\">\n    <!-- <div class=\"card-header\">\n      <h5 class=\"mb-0\">Product Create</h5>\n    </div> -->\n    <Loader :loading=\"loading\" />\n    <div class=\"card-body\">\n      {{ form }}\n      <form @submit.prevent=\"createProduct()\">\n        <div class=\"d-flex justify-content-center\">\n          <img\n            v-if=\"imageUrl\"\n            :src=\"imageUrl\"\n            alt=\"Uploaded Image\"\n            class=\"mt-3 img-thumbnail\"\n            width=\"124\"\n            height=\"72\"\n          />\n          <img\n            v-else\n            src=\"https://t4.ftcdn.net/jpg/02/51/95/53/360_F_251955356_FAQH0U1y1TZw3ZcdPGybwUkH90a3VAhb.jpg\"\n            alt=\"\"\n            width=\"124\"\n            height=\"72\"\n          />\n        </div>\n        <p v-if=\"form.file\" class=\"my-2 text-center\">{{ form.file.name }}</p>\n\n        <div class=\"mb-2\">\n          <div class=\"d-flex flex-column align-items-center\">\n            <div class=\"\" v-if=\"!form.file\">\n              <label for=\"file-upload\" class=\"custom-file-upload btn btn-primary btn-sm\">\n                อัพโหลดรูปภาพ\n              </label>\n              <input id=\"file-upload\" type=\"file\" @change=\"handleFileUpload\" />\n            </div>\n            <div v-else>\n              <button class=\"btn btn-danger btn-sm\" @click=\"cancelImage()\">ยกเลิก</button>\n            </div>\n          </div>\n        </div>\n        <div class=\"mb-3\">\n          <label for=\"exampleInputEmail1\" class=\"form-label\">สินค้า</label>\n          <input type=\"text\" class=\"form-control form-control-sm\" v-model=\"form.name\" />\n          <!-- <div id=\"emailHelp\" class=\"form-text\">\n            We'll never share your email with anyone else.\n          </div> -->\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <div class=\"mb-3\">\n                <label for=\"exampleInputEmail1\" class=\"form-label\">รหัสสินค้า</label>\n                <input\n                  type=\"text\"\n                  class=\"form-control form-control-sm\"\n                  v-model=\"form.barcode\"\n                />\n                <!-- <div id=\"emailHelp\" class=\"form-text\">\n            We'll never share your email with anyone else.\n          </div> -->\n              </div>\n            </div>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label class=\"form-label\">จำนวน</label>\n              <input\n                type=\"number\"\n                class=\"form-control form-control-sm\"\n                v-model=\"form.quantity\"\n              />\n            </div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label class=\"form-label\">ราคาทุน</label>\n              <input\n                type=\"number\"\n                class=\"form-control form-control-sm\"\n                v-model=\"form.cost\"\n              />\n            </div>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label class=\"form-label\">ราคาขาย</label>\n              <input\n                type=\"number\"\n                class=\"form-control form-control-sm\"\n                v-model=\"form.price\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label class=\"form-label\">หมวดหมู่</label>\n              <select class=\"form-select form-select-sm\" @change=\"selectedCategory\">\n                <option value=\"\" disabled selected>เลือกหมวดหมู่</option>\n                <option\n                  :value=\"category.id\"\n                  v-for=\"(category, index) in categorys\"\n                  :key=\"index\"\n                >\n                  {{ category?.name }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"mb-3\">\n              <label class=\"form-label\">ประเภท</label>\n              <select class=\"form-select form-select-sm\" @change=\"selectedSubCategory\">\n                <option value=\"\" disabled selected>เลือกประเภท</option>\n                <option\n                  :value=\"subCategory.id\"\n                  v-for=\"(subCategory, index) in sub_categorys\"\n                  :key=\"index\"\n                >\n                  {{ subCategory?.name }}\n                </option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <div class=\"mb-3\">\n          <label for=\"\" class=\"form-label\">รายละเอียด</label>\n          <textarea\n            class=\"form-control\"\n            cols=\"30\"\n            rows=\"3\"\n            v-model=\"form.description\"\n          ></textarea>\n        </div>\n        <div class=\"mb-3\">\n          <div class=\"form-check\">\n            <input\n              class=\"form-check-input\"\n              type=\"radio\"\n              :checked=\"Boolean(form.is_active)\"\n              @click=\"form.is_active = true\"\n            />\n            <label class=\"form-check-label\" for=\"flexRadioDefault1\"> เปิดขาย </label>\n          </div>\n          <div class=\"form-check\">\n            <input\n              class=\"form-check-input\"\n              type=\"radio\"\n              :checked=\"!form.is_active\"\n              @click=\"form.is_active = false\"\n            />\n            <label class=\"form-check-label\" for=\"flexRadioDefault2\"> ไม่เปิดขาย </label>\n          </div>\n        </div>\n\n        <button type=\"submit\" class=\"btn btn-primary btn-sm\">Submit</button>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { categoryData } from \"~/types/categoryType\";\nimport type { subCategoryType } from \"~/types/subCategoryType\";\nimport type { productFormData } from \"~/types/productType\";\nconst form = ref<productFormData>({\n  id:null,\n  name: \"\",\n  barcode: \"\",\n  is_active: 1,\n  price: 0,\n  category: \"\",\n  sub_category: \"\",\n  description: \"\",\n  quantity: 0,\n  cost: 0,\n  file: null,\n  file_path: \"\",\n\n});\n\nconst loading = ref<boolean>(false);\nconst imageUrl = ref<string>(\"\");\nconst categorys = ref<categoryData[] | null>(null);\nconst sub_categorys = ref<subCategoryType[] | null>(null);\n\nconst allCategorys = async () => {\n  loading.value = true;\n  try {\n    const response = await fetch(\"/api/category\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await response.json();\n    categorys.value = data.data;\n  } catch (e) {\n    console.log(e);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst selectedCategory = async (event: Event) => {\n  loading.value = true;\n\n  try {\n    const target = event.target as HTMLSelectElement;\n    const selectedValue = target.value;\n\n    // สร้าง object ใหม่เพื่อกำหนดค่าให้กับ form.value.category\n    form.value.category = selectedValue;\n    await allSubCategory(selectedValue);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst selectedSubCategory = async (event: Event) => {\n  try {\n    const target = event.target as HTMLSelectElement;\n    const selectedValue = target.value;\n\n    // สร้าง object ใหม่เพื่อกำหนดค่าให้กับ form.value.category\n    form.value.sub_category = selectedValue;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst allSubCategory = async (category_id: string) => {\n  try {\n    const response = await fetch(\"/api/category/\" + category_id + \"/subcategory\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await response.json();\n    sub_categorys.value = data.data;\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nconst createProduct = async () => {\n  loading.value = true;\n  try {\n    const formData = new FormData();\n    if (form.value.file) {\n      formData.append(\"file\", form.value.file);\n    }\n    // Append other form data if needed\n    formData.append(\"name\", form.value.name);\n    formData.append(\"barcode\", form.value.barcode);\n    formData.append(\"isActive\", form.value.is_active ? \"1\" : \"0\");\n    formData.append(\"price\", form.value.price.toString());\n    formData.append(\"category\", form.value.category.toString());\n    formData.append(\"sub_category\", form.value.sub_category.toString());\n    formData.append(\"description\", form.value.description);\n    formData.append(\"quantity\", form.value.quantity.toString());\n    formData.append(\"cost\", form.value.cost.toString());\n\n    const response = await fetch(\"/api/product\", {\n      method: \"POST\",\n      body: formData,\n    });\n    const data = await response.json();\n    console.log(data);\n  } catch (e) {\n    console.log(e);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst handleFileUpload = (event: Event) => {\n  const target = event.target as HTMLInputElement;\n  const fileValue = target.files?.[0] || null;\n  form.value.file = fileValue;\n  if (fileValue) {\n    imageUrl.value = URL.createObjectURL(fileValue);\n  }\n};\n\nconst cancelImage = () => {\n  form.value.file = null;\n  imageUrl.value = \"\";\n};\n\nonMounted(() => {\n  allCategorys();\n});\n</script>\n\n<style scoped>\ninput[type=\"file\"] {\n  display: none;\n}\n\n.custom-file-upload {\n  display: inline-block;\n  cursor: pointer;\n  padding: 0.5rem 1rem;\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: #fff;\n  background-color: #007bff;\n  border: 1px solid transparent;\n  border-radius: 0.25rem;\n  transition: background-color 0.2s ease-in-out;\n}\n\n.custom-file-upload:hover {\n  background-color: #0056b3;\n}\n\n.position-relative {\n  position: relative;\n}\n.spinner-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(255, 255, 255, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n</style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA0KA,UAAM,OAAO,IAAqB;AAAA,MAChC,IAAG;AAAA,MACH,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW;AAAA,MACX,OAAO;AAAA,MACP,UAAU;AAAA,MACV,cAAc;AAAA,MACd,aAAa;AAAA,MACb,UAAU;AAAA,MACV,MAAM;AAAA,MACN,MAAM;AAAA,MACN,WAAW;AAAA,IAAA,CAEZ;AAEK,UAAA,UAAU,IAAa,KAAK;AAC5B,UAAA,WAAW,IAAY,EAAE;AACzB,UAAA,YAAY,IAA2B,IAAI;AAC3C,UAAA,gBAAgB,IAA8B,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}