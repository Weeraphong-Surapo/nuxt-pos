import{_ as ot}from"./B8mqVfVr.js";import{_ as st}from"./BDY35pRu.js";import{o as _,c as h,a as t,H as at,n as H,B as nt,C as lt,w as I,r as u,I as f,z as it,b as C,u as l,t as k,d as $,F as A,E as O,s as D,v as F,J as G,G as ct,p as rt,e as dt,A as ut,_ as pt}from"./DV78moFj.js";const vt={class:"modal-dialog modal-xl",id:"exampleModal"},bt={class:"modal-content"},_t=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"Modal title"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),mt={class:"modal-body"},ht={__name:"ModalPos",props:["total_price"],setup(d){return(y,S)=>(_(),h("div",vt,[t("div",bt,[_t,t("div",mt,[at(y.$slots,"default")])])]))}},yt={class:"btn-group"},gt=["onClick"],ft=t("i",{class:"bi bi-cart-plus-fill"},null,-1),xt=[ft],wt=["src"],Ct=H({__name:"TablePos",props:["products","fetchProduct","loading","addToCart"],setup(d){const y=[{text:"บาร์โค้ด",value:"barcode",sortable:!0},{text:"รูปภาพ",value:"image"},{text:"สินค้า",value:"name",sortable:!0},{text:"ราคา",value:"price",sortable:!0},{text:"จำนวน",value:"quantity"},{text:"Action",value:"action"}];return(S,T)=>{const p=nt("EasyDataTable");return _(),lt(p,{headers:y,items:d.products,"theme-color":"#5c60f5",loading:d.loading,"rows-per-page":9},{"item-action":I(c=>[t("div",yt,[t("button",{class:"btn btn-primary btn-sm",type:"button",onClick:v=>d.addToCart(c)},xt,8,gt)])]),"item-image":I(({file_path:c})=>[t("img",{src:c,alt:"",style:{height:"60px",width:"80px","object-fit":"cover"},class:"rounded"},null,8,wt)]),_:1},8,["items","loading"])}}}),i=d=>(rt("data-v-d95aec05"),d=d(),dt(),d),kt={class:"container-fluid px-0"},$t={class:"row"},It={class:"col-md-7"},St={class:"card border border-bottom-0 border-end-0 border-start-0 border-4 vh-100"},Tt={class:"card-header d-flex justify-content-between align-items-center"},Nt=i(()=>t("div",{class:"input-group mb-3 input-group-sm"},[t("span",{class:"input-group-text",id:"basic-addon1"},[t("i",{class:"bi bi-person-circle"})]),t("input",{readonly:"",type:"text",class:"form-control form-control-sm",placeholder:"วีระพงษ์ สุราโพธิ์"})],-1)),qt={class:"input-group input-group-sm mb-3"},Bt=i(()=>t("span",{class:"input-group-text"},[t("i",{class:"bi bi-people-fill"})],-1)),Mt=i(()=>t("option",{value:"",disabled:"",selected:""},"เลือกลูกค้า",-1)),jt=["value"],At=i(()=>t("button",{type:"button",class:"input-group-text bg-dark text-white"}," ยกเลิก ",-1)),Vt=i(()=>t("div",{class:"border border-1 border-warning"},null,-1)),Et={class:"text-center mt-1"},Lt={class:"card-body mb-0 pb-0",style:{"max-height":"calc(100vh - 150px)","overflow-y":"auto"}},Pt={class:"input-group input-group-sm rounded-0"},Jt=["onClick"],Ot=["value"],Dt={class:"d-flex"},Ft=["onClick"],Gt={style:{width:"70px"},class:"text-center border"},Ht=["onClick"],zt={class:"input-group input-group-sm w-100"},Qt=["value"],Ut=i(()=>t("button",{type:"button",class:"input-group-text bg-info text-white rounded-0"}," ฿ ",-1)),Rt={class:"p-3 border-3 border-secondary"},Xt={class:"row mb-3"},Kt=i(()=>t("label",{for:"",class:"col-sm-2 col-form-label"},"เปอร์เซ็น (VAT)",-1)),Wt={class:"col-sm-10"},Yt={class:"row mb-3"},Zt=i(()=>t("label",{for:"",class:"col-sm-2 col-form-label"},"ภาษี",-1)),te={class:"col-sm-10"},ee=["value"],oe={class:"row mb-3"},se=i(()=>t("label",{for:"",class:"col-sm-2 col-form-label"},"รวมทั้งสิ้น",-1)),ae={class:"col-sm-10"},ne=["value"],le=["disabled"],ie={class:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},ce={class:"row"},re={class:"col-12"},de={class:"list-group list-group-horizontal-sm",id:"list-tab",role:"tablist"},ue={class:"col-12"},pe={class:"tab-content",id:"nav-tabContent"},ve={class:"tab-pane fade show active",id:"list-home",role:"tabpanel","aria-labelledby":"list-home-list"},be={class:"row"},_e={class:"col-md-6"},me={class:"my-3"},he={class:"input-group flex-nowrap"},ye=i(()=>t("span",{class:"input-group-text",style:{width:"150px"},id:"addon-wrapping"},"ยอดรวมเงินชำระ",-1)),ge=["value"],fe={class:"mb-3"},xe={class:"input-group flex-nowrap"},we=i(()=>t("span",{class:"input-group-text",style:{width:"150px"},id:"addon-wrapping"},"ยอดรับเงิน",-1)),Ce={class:"mb-3"},ke={class:"input-group flex-nowrap"},$e=i(()=>t("span",{class:"input-group-text",style:{width:"150px"},id:"addon-wrapping"},"ยอดเงินทอน",-1)),Ie=["value"],Se={class:"row"},Te={class:"col-md-6"},Ne=i(()=>t("button",{type:"button",class:"btn btn-secondary w-100","data-bs-dismiss":"modal"}," ปิด ",-1)),qe={class:"col-md-6"},Be={class:"calculator mt-3"},Me={class:"calculator-keys"},je={class:"tab-pane fade",id:"list-profile",role:"tabpanel","aria-labelledby":"list-profile-list"},Ae=i(()=>t("span",{class:"text-muted d-block my-3"},[$(" เมื่อลูกค้าทำการโอนเงินผ่านธนาคารออนไลน์ "),t("span",{class:"text-danger"},"แนะนำให้คุณตรวจสอบเลขที่บัญชีและข้อมูลการโอนให้ถูกต้อง และให้เก็บหลักฐานการโอนเงินเอาไว้"),$(" เมื่อโอนเงินเสร็จสิ้น "),t("span",{class:"text-success"},'คุณสามารถปุ่ม "ชำระเงินแล้ว"'),$(" เพื่อช่วยให้กระบวนการดำเนินการได้รวดเร็วและถูกต้อง.")],-1)),Ve={class:"d-flex justify-content-center"},Ee={class:"col-md-5"},Le={class:"card border border-bottom-0 border-start-0 border-end-0 border-4"},Pe=ct('<div class="card-header" data-v-d95aec05><input type="text" class="form-control mb-3 border-danger" placeholder="search..." data-v-d95aec05><select class="form-select form-select-sm border-danger" data-v-d95aec05><option value="" data-v-d95aec05></option><option value="" data-v-d95aec05></option></select></div>',1),Je={class:"card-bod"},Oe={class:"table-responsive"},De=H({__name:"index",setup(d){const y=ut(),S=o=>{y.$toast.success(o,{position:"bottom-right",timeout:2500})},T=u([]),p=u(0),c=u(""),v=u(0),m=u(!1),s=u([]),V=u([]),N=u(0),q=f(()=>c.value==""?0:c.value),E=async()=>{m.value=!0;try{await Y();const e=await(await fetch("/api/product",{method:"GET",headers:{"Content-Type":"application/json"}})).json();T.value=e.data}catch(o){console.log(o)}finally{m.value=!1}},r=o=>{c.value+=o},z=o=>{const e=s.value.findIndex(n=>n.id===o.id);if(e!==-1)s.value[e].qty++,s.value[e].total_price=s.value[e].price*s.value[e].qty;else{const n={id:o.id,name:o.name,price:o.price,stock:o.quantity,qty:1,total_price:o.price*1};s.value.push(n),localStorage.setItem("cart",JSON.stringify(s.value))}},Q=o=>{const e=s.value.findIndex(n=>n.id===o);e!==-1&&s.value.splice(e,1),localStorage.setItem("cart",JSON.stringify(s.value))},U=o=>{const e=s.value.findIndex(n=>n.id===o);e!==-1&&s.value[e].qty<s.value[e].stock&&(s.value[e].qty++,s.value[e].total_price=s.value[e].price*s.value[e].qty),localStorage.setItem("cart",JSON.stringify(s.value))},R=o=>{const e=s.value.findIndex(n=>n.id===o);e!==-1&&(s.value[e].qty>1?(s.value[e].qty--,s.value[e].total_price=s.value[e].price*s.value[e].qty):s.value.splice(e,1)),localStorage.setItem("cart",JSON.stringify(s.value))},X=()=>{c.value=Number(b.value)},B=f(()=>s.value.reduce((o,e)=>o+e.price*e.qty,0)),b=f(()=>{let o;return v.value>0?o=s.value.reduce((e,n)=>e+n.price*n.qty,0)+g.value:o=s.value.reduce((e,n)=>e+n.price*n.qty,0),o}),g=f(()=>{const o=s.value.reduce((n,w)=>n+w.price*w.qty,0);return v.value?o*v.value/100:0}),x=o=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(o),M=f(()=>b.value-c.value),K=()=>{c.value=0},W=()=>{c.value=c.value.slice(0,-1)},L=()=>{const o=localStorage.getItem("cart");o&&(s.value=JSON.parse(o))},P=async()=>{m.value=!0;let o;p.value==0?o={customer:N.value,total_price:B.value,vat:g.value,total_price_sum_vat:b.value,getMoney:c.value,change_money:M.value,type_pay:p.value,orders:s.value}:o={customer:N.value,total_price:B.value,vat:g.value,total_price_sum_vat:b.value,getMoney:b.value,change_money:M.value,type_pay:p.value,orders:s.value};try{const n=await(await fetch("/api/sale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();s.value=[],localStorage.removeItem("cart"),L(),S("บันทึกรายการขายเรียบร้อย")}catch(e){console.log(e)}finally{m.value=!1,document.getElementById("staticBackdrop").classList.remove("show")}},Y=async()=>{try{const e=await(await fetch("/api/customer",{method:"GET",headers:{"Content-Type":"application/json"}})).json();V.value=e.data}catch(o){console.log(o)}},Z=o=>{const n=o.target.value;N.value=Number(n)};return it(()=>{E(),L()}),(o,e)=>{const n=ot,w=st,tt=ht,et=Ct;return _(),h(A,null,[C(n,{loading:l(m)},null,8,["loading"]),t("div",kt,[t("div",$t,[t("div",It,[t("div",St,[t("div",Tt,[t("h2",null,"ขายสินค้าหน้าร้าน "+k(l(g)),1),C(w,{to:{name:"index"},class:"btn btn-danger btn-sm"},{default:I(()=>[$("Exit")]),_:1})]),Nt,t("div",qt,[Bt,t("select",{class:"form-select form-select-sm",onChange:Z},[Mt,(_(!0),h(A,null,O(l(V),(a,j)=>(_(),h("option",{value:a.id,key:j},k(a.full_name),9,jt))),128))],32),At]),Vt,t("p",Et,"รายการสินค้า ("+k(l(s).length)+")",1),t("div",Lt,[(_(!0),h(A,null,O(l(s),(a,j)=>(_(),h("div",{class:"d-flex align-items-center mb-3",key:j,style:{"overflow-y":"auto"}},[t("div",Pt,[t("button",{onClick:J=>Q(a.id),type:"button",class:"input-group-text bg-danger text-white rounded-0"}," X ",8,Jt),t("input",{readonly:"",type:"text",class:"form-control form-control-sm rounded-0",value:a.name},null,8,Ot)]),t("div",Dt,[t("button",{class:"btn btn-warning btn-sm rounded-0",onClick:J=>R(a.id)}," - ",8,Ft),t("span",Gt,k(a.qty),1),t("button",{class:"btn btn-primary btn-sm rounded-0",onClick:J=>U(a.id)}," + ",8,Ht)]),t("div",zt,[t("input",{readonly:"",type:"text",class:"form-control form-control-sm text-end rounded-0",value:a.total_price},null,8,Qt),Ut])]))),128))]),t("div",Rt,[t("div",Xt,[Kt,t("div",Wt,[D(t("input",{type:"number",class:"form-control form-control-sm text-end","onUpdate:modelValue":e[0]||(e[0]=a=>G(v)?v.value=a:null)},null,512),[[F,l(v)]])])]),t("div",Yt,[Zt,t("div",te,[t("input",{readonly:"",type:"text",class:"form-control form-control-sm text-end",value:x(l(g))},null,8,ee)])]),t("div",oe,[se,t("div",ae,[t("input",{type:"text",class:"form-control form-control-sm text-end",value:x(l(b)),readonly:""},null,8,ne)])])]),t("button",{class:"btn btn-success w-100 rounded-0 btn-lg","data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",disabled:l(s).length<1}," ดำเนินการต่อ ",8,le),t("div",ie,[C(tt,{total_price:l(B)},{default:I(()=>[t("div",ce,[t("div",re,[t("div",de,[t("a",{class:"list-group-item list-group-item-action active text-center",id:"list-home-list","data-bs-toggle":"list",href:"#list-home",role:"tab","aria-controls":"list-home",onClick:e[1]||(e[1]=a=>p.value=0)},"ชำระเงินสด"),t("a",{class:"list-group-item list-group-item-action text-center",id:"list-profile-list","data-bs-toggle":"list",href:"#list-profile",role:"tab","aria-controls":"list-profile",onClick:e[2]||(e[2]=a=>p.value=1)},"โอนชำระ")])]),t("div",ue,[t("div",pe,[t("div",ve,[t("div",be,[t("div",_e,[t("div",me,[t("div",he,[ye,t("input",{type:"text",class:"form-control from-control-sm text-end",value:x(l(b)),readonly:""},null,8,ge)])]),t("div",fe,[t("div",xe,[we,D(t("input",{type:"text",class:"form-control from-control-sm text-end","onUpdate:modelValue":e[3]||(e[3]=a=>G(q)?q.value=a:null)},null,512),[[F,l(q)]])])]),t("div",Ce,[t("div",ke,[$e,t("input",{type:"text",class:"form-control from-control-sm text-end",value:x(l(M)),readonly:""},null,8,Ie)])]),t("div",Se,[t("div",{class:"col-md-6"},[t("button",{type:"button",class:"btn btn-info text-white w-100 mb-3",onClick:X}," ชำระเงินพอดี ")]),t("div",Te,[t("button",{type:"button",class:"btn btn-success w-100 mb-3",onClick:e[4]||(e[4]=a=>P())}," ชำระเงิน ")])]),Ne]),t("div",qe,[t("div",Be,[t("div",Me,[t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[5]||(e[5]=a=>r("7"))}," 7 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[6]||(e[6]=a=>r("8"))}," 8 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[7]||(e[7]=a=>r("9"))}," 9 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[8]||(e[8]=a=>r("4"))}," 4 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[9]||(e[9]=a=>r("5"))}," 5 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[10]||(e[10]=a=>r("6"))}," 6 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[11]||(e[11]=a=>r("1"))}," 1 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[12]||(e[12]=a=>r("2"))}," 2 "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[13]||(e[13]=a=>r("3"))}," 3 "),t("button",{type:"button",class:"decimal text-white btn-hover bg-primary",onClick:W}," <= "),t("button",{type:"button",class:"bg-primary text-white btn-hover",onClick:e[14]||(e[14]=a=>r("0"))}," 0 "),t("button",{type:"button",class:"all-clear text-white btn-hover bg-primary",onClick:e[15]||(e[15]=a=>K())}," AC ")])])])])]),t("div",je,[Ae,t("div",Ve,[t("button",{class:"btn btn-success btn-lg",onClick:e[16]||(e[16]=a=>P())}," ชำระเงินแล้ว ")])])])])])]),_:1},8,["total_price"])])])]),t("div",Ee,[t("div",Le,[Pe,t("div",Je,[t("div",Oe,[C(et,{fetchProduct:E,products:l(T),loading:l(m),addToCart:z},null,8,["products","loading"])])])])])])])],64)}}}),ze=pt(De,[["__scopeId","data-v-d95aec05"]]);export{ze as default};
